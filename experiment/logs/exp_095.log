======================================================================
Informer Native Training Log
Experiment: exp_095
Started: 2025-11-01 00:33:37
======================================================================

Command:
C:\ProgramData\anaconda3\python.exe E:\ANUS_learning\MSI5001-power-transformer-oil-temperature-prediction\external\Informer2020\main_informer.py --model informer --data custom --root_path ./data/ --data_pa======================================================================
Experiment: exp_095
======================================================================
Transformer:     TX2
Model:           Informer
Split method:    chronological
Feature mode:    full_6loads
Data suffix:     _no_outlier

Loading data...
  Total samples: 69680
  Features: 21 columns

Window config: WindowConfig(horizon=24, lookback=96, gap=0)
Creating sliding windows for Informer (keeping sequence structure)...
  Created 69560 windows (shape: (69560, 96, 21))
Splitting windows (chronological, 20% test)...
  Train: 55648 windows
  Test:  13912 windows

Training Informer...

Calling native Informer from: E:\ANUS_learning\MSI5001-power-transformer-oil-temperature-prediction\external\Informer2020
Command: C:\ProgramData\anaconda3\python.exe E:\ANUS_learning\MSI5001-power-transformer-oil-temperature-prediction\external\Informer2020\main_informer.py --model informer --data custom --root_path ./data/ --data_path TX2.csv --features MS --target OT --freq h --seq_len 96 --label_len 48 --pred_len 24 --enc_in 6 --dec_in 1 --c_out 1 --d_model 256 --n_heads 8 --e_layers 2 --d_layers 1 --d_ff 1024 --factor 5 --dropout 0.05 --attn prob --embed timeF --activation gelu --batch_size 16 --train_epochs 10 --patience 3 --learning_rate 0.0001 --des exp_095 --itr 1
Args in experiment:
Namespace(model='informer', data='custom', root_path='./data/', data_path='TX1.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=24, enc_in=6, dec_in=1, c_out=1, d_model=256, n_heads=8, e_layers=2, d_layers=1, s_layers=[3, 2, 1], d_ff=1024, factor=5, padding=0, distil=True, dropout=0.05, attn='prob', embed='timeF', activation='gelu', output_attention=False, do_predict=False, mix=True, cols=None, num_workers=0, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='exp_095', loss='mse', lradj='type1', use_amp=False, inverse=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', detail_freq='h')
Use GPU: cuda:0
>>>>>>>start training : informer_custom_ftMS_sl96_ll48_pl24_dm256_nh8_el2_dl1_df1024_atprob_fc5_ebtimeF_dtTrue_mxTrue_exp_095_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 48657
val 6945
test 13913
	iters: 100, epoch: 1 | loss: 0.0828126
	speed: 0.0215s/iter; left time: 651.8913s
	iters: 200, epoch: 1 | loss: 0.0408737
	speed: 0.0110s/iter; left time: 331.7931s
	iters: 300, epoch: 1 | loss: 0.1009740
	speed: 0.0114s/iter; left time: 344.3354s
	iters: 400, epoch: 1 | loss: 0.0993616
	speed: 0.0114s/iter; left time: 343.2002s
	iters: 500, epoch: 1 | loss: 0.0768046
	speed: 0.0113s/iter; left time: 338.7064s
	iters: 600, epoch: 1 | loss: 0.0502515
	speed: 0.0114s/iter; left time: 339.3812s
	iters: 700, epoch: 1 | loss: 0.0744856
	speed: 0.0114s/iter; left time: 337.9836s
	iters: 800, epoch: 1 | loss: 0.1532740
	speed: 0.0117s/iter; left time: 345.8134s
	iters: 900, epoch: 1 | loss: 0.0459059
	speed: 0.0116s/iter; left time: 342.1775s
	iters: 1000, epoch: 1 | loss: 0.1096501
	speed: 0.0118s/iter; left time: 346.5102s
	iters: 1100, epoch: 1 | loss: 0.0528293
	speed: 0.0117s/iter; left time: 342.2918s
	iters: 1200, epoch: 1 | loss: 0.0705314
	speed: 0.0121s/iter; left time: 353.5820s
	iters: 1300, epoch: 1 | loss: 0.0687521
	speed: 0.0118s/iter; left time: 342.8991s
	iters: 1400, epoch: 1 | loss: 0.0513157
	speed: 0.0118s/iter; left time: 343.6536s
	iters: 1500, epoch: 1 | loss: 0.0523452
	speed: 0.0118s/iter; left time: 339.7672s
	iters: 1600, epoch: 1 | loss: 0.0872088
	speed: 0.0114s/iter; left time: 328.8645s
	iters: 1700, epoch: 1 | loss: 0.0433795
	speed: 0.0112s/iter; left time: 322.0029s
	iters: 1800, epoch: 1 | loss: 0.0373831
	speed: 0.0112s/iter; left time: 321.2967s
	iters: 1900, epoch: 1 | loss: 0.0779875
	speed: 0.0117s/iter; left time: 332.5261s
	iters: 2000, epoch: 1 | loss: 0.0671843
	speed: 0.0115s/iter; left time: 325.6810s
	iters: 2100, epoch: 1 | loss: 0.0564711
	speed: 0.0119s/iter; left time: 337.4207s
	iters: 2200, epoch: 1 | loss: 0.0677525
	speed: 0.0115s/iter; left time: 323.4176s
	iters: 2300, epoch: 1 | loss: 0.1157758
	speed: 0.0113s/iter; left time: 317.3887s
	iters: 2400, epoch: 1 | loss: 0.1002355
	speed: 0.0112s/iter; left time: 313.4378s
	iters: 2500, epoch: 1 | loss: 0.0494606
	speed: 0.0119s/iter; left time: 331.2806s
	iters: 2600, epoch: 1 | loss: 0.0375625
	speed: 0.0116s/iter; left time: 322.3358s
	iters: 2700, epoch: 1 | loss: 0.0910163
	speed: 0.0118s/iter; left time: 326.7880s
	iters: 2800, epoch: 1 | loss: 0.0569249
	speed: 0.0140s/iter; left time: 386.2685s
	iters: 2900, epoch: 1 | loss: 0.1212002
	speed: 0.0133s/iter; left time: 366.5745s
	iters: 3000, epoch: 1 | loss: 0.0819238
	speed: 0.0116s/iter; left time: 316.6809s
Epoch: 1 cost time: 35.87445950508118
Epoch: 1, Steps: 3041 | Train Loss: 0.0758139 Vali Loss: 0.0513247 Test Loss: 0.0668602
Validation loss decreased (inf --> 0.051325).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0453701
	speed: 0.0757s/iter; left time: 2063.9224s
	iters: 200, epoch: 2 | loss: 0.0454129
	speed: 0.0119s/iter; left time: 322.6138s
	iters: 300, epoch: 2 | loss: 0.0484190
	speed: 0.0116s/iter; left time: 314.9504s
	iters: 400, epoch: 2 | loss: 0.1033713
	speed: 0.0112s/iter; left time: 301.2742s
	iters: 500, epoch: 2 | loss: 0.0363184
	speed: 0.0110s/iter; left time: 296.4843s
	iters: 600, epoch: 2 | loss: 0.0322755
	speed: 0.0110s/iter; left time: 294.5376s
	iters: 700, epoch: 2 | loss: 0.0477580
	speed: 0.0110s/iter; left time: 293.8718s
	iters: 800, epoch: 2 | loss: 0.0618332
	speed: 0.0112s/iter; left time: 297.7480s
	iters: 900, epoch: 2 | loss: 0.0515673
	speed: 0.0115s/iter; left time: 304.2003s
	iters: 1000, epoch: 2 | loss: 0.0370384
	speed: 0.0114s/iter; left time: 301.9074s
	iters: 1100, epoch: 2 | loss: 0.0396917
	speed: 0.0120s/iter; left time: 315.6864s
	iters: 1200, epoch: 2 | loss: 0.0343778
	speed: 0.0112s/iter; left time: 292.9686s
	iters: 1300, epoch: 2 | loss: 0.0409603
	speed: 0.0120s/iter; left time: 313.3113s
	iters: 1400, epoch: 2 | loss: 0.0299362
	speed: 0.0117s/iter; left time: 304.0622s
	iters: 1500, epoch: 2 | loss: 0.0628231
	speed: 0.0117s/iter; left time: 302.1717s
	iters: 1600, epoch: 2 | loss: 0.0328917
	speed: 0.0117s/iter; left time: 302.2814s
	iters: 1700, epoch: 2 | loss: 0.0392571
	speed: 0.0119s/iter; left time: 304.2424s
	iters: 1800, epoch: 2 | loss: 0.0348169
	speed: 0.0113s/iter; left time: 288.2200s
	iters: 1900, epoch: 2 | loss: 0.0221943
	speed: 0.0116s/iter; left time: 296.3992s
	iters: 2000, epoch: 2 | loss: 0.0925093
	speed: 0.0118s/iter; left time: 299.6057s
	iters: 2100, epoch: 2 | loss: 0.0405945
	speed: 0.0111s/iter; left time: 281.4464s
	iters: 2200, epoch: 2 | loss: 0.0422203
	speed: 0.0109s/iter; left time: 274.4863s
	iters: 2300, epoch: 2 | loss: 0.0404975
	speed: 0.0113s/iter; left time: 282.5004s
	iters: 2400, epoch: 2 | loss: 0.0246247
	speed: 0.0116s/iter; left time: 290.1225s
	iters: 2500, epoch: 2 | loss: 0.0489211
	speed: 0.0112s/iter; left time: 279.7201s
	iters: 2600, epoch: 2 | loss: 0.0476921
	speed: 0.0113s/iter; left time: 279.0049s
	iters: 2700, epoch: 2 | loss: 0.0356239
	speed: 0.0115s/iter; left time: 282.6027s
	iters: 2800, epoch: 2 | loss: 0.0553861
	speed: 0.0111s/iter; left time: 273.3903s
	iters: 2900, epoch: 2 | loss: 0.0324516
	speed: 0.0123s/iter; left time: 300.2884s
	iters: 3000, epoch: 2 | loss: 0.0337675
	speed: 0.0116s/iter; left time: 282.8456s
Epoch: 2 cost time: 34.883792877197266
Epoch: 2, Steps: 3041 | Train Loss: 0.0446659 Vali Loss: 0.1594314 Test Loss: 0.1336940
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0423836
	speed: 0.0749s/iter; left time: 1814.8326s
	iters: 200, epoch: 3 | loss: 0.0406043
	speed: 0.0119s/iter; left time: 287.4723s
	iters: 300, epoch: 3 | loss: 0.0293923
	speed: 0.0116s/iter; left time: 279.8889s
	iters: 400, epoch: 3 | loss: 0.0211315
	speed: 0.0115s/iter; left time: 274.1931s
	iters: 500, epoch: 3 | loss: 0.0202804
	speed: 0.0117s/iter; left time: 279.9342s
	iters: 600, epoch: 3 | loss: 0.0292406
	speed: 0.0126s/iter; left time: 297.8583s
	iters: 700, epoch: 3 | loss: 0.0303961
	speed: 0.0113s/iter; left time: 267.1203s
	iters: 800, epoch: 3 | loss: 0.0265353
	speed: 0.0114s/iter; left time: 268.0477s
	iters: 900, epoch: 3 | loss: 0.0362504
	speed: 0.0112s/iter; left time: 261.4588s
	iters: 1000, epoch: 3 | loss: 0.0287056
	speed: 0.0110s/iter; left time: 256.0185s
	iters: 1100, epoch: 3 | loss: 0.0271367
	speed: 0.0112s/iter; left time: 260.2325s
	iters: 1200, epoch: 3 | loss: 0.0137932
	speed: 0.0111s/iter; left time: 256.5278s
	iters: 1300, epoch: 3 | loss: 0.0341287
	speed: 0.0116s/iter; left time: 266.0752s
	iters: 1400, epoch: 3 | loss: 0.0234283
	speed: 0.0113s/iter; left time: 259.9100s
	iters: 1500, epoch: 3 | loss: 0.0242638
	speed: 0.0112s/iter; left time: 256.2542s
	iters: 1600, epoch: 3 | loss: 0.0303987
	speed: 0.0115s/iter; left time: 261.8881s
	iters: 1700, epoch: 3 | loss: 0.0184640
	speed: 0.0117s/iter; left time: 264.7514s
	iters: 1800, epoch: 3 | loss: 0.0237727
	speed: 0.0115s/iter; left time: 258.4977s
	iters: 1900, epoch: 3 | loss: 0.0362276
	speed: 0.0123s/iter; left time: 276.3630s
	iters: 2000, epoch: 3 | loss: 0.0260215
	speed: 0.0120s/iter; left time: 268.7264s
	iters: 2100, epoch: 3 | loss: 0.0280743
	speed: 0.0115s/iter; left time: 256.2523s
	iters: 2200, epoch: 3 | loss: 0.0220511
	speed: 0.0113s/iter; left time: 249.4826s
	iters: 2300, epoch: 3 | loss: 0.0364090
	speed: 0.0116s/iter; left time: 255.4641s
	iters: 2400, epoch: 3 | loss: 0.0214832
	speed: 0.0116s/iter; left time: 254.7584s
	iters: 2500, epoch: 3 | loss: 0.0194949
	speed: 0.0113s/iter; left time: 247.3054s
	iters: 2600, epoch: 3 | loss: 0.0427268
	speed: 0.0114s/iter; left time: 247.1511s
	iters: 2700, epoch: 3 | loss: 0.0103928
	speed: 0.0110s/iter; left time: 238.6239s
	iters: 2800, epoch: 3 | loss: 0.0218304
	speed: 0.0112s/iter; left time: 240.9674s
	iters: 2900, epoch: 3 | loss: 0.0222540
	speed: 0.0114s/iter; left time: 243.9678s
	iters: 3000, epoch: 3 | loss: 0.0231310
	speed: 0.0115s/iter; left time: 244.8948s
Epoch: 3 cost time: 34.949140787124634
Epoch: 3, Steps: 3041 | Train Loss: 0.0275604 Vali Loss: 0.1408515 Test Loss: 0.1006706
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0219166
	speed: 0.0754s/iter; left time: 1597.4176s
	iters: 200, epoch: 4 | loss: 0.0171375
	speed: 0.0114s/iter; left time: 241.4555s
	iters: 300, epoch: 4 | loss: 0.0178609
	speed: 0.0115s/iter; left time: 241.1251s
	iters: 400, epoch: 4 | loss: 0.0219289
	speed: 0.0116s/iter; left time: 242.7134s
	iters: 500, epoch: 4 | loss: 0.0223317
	speed: 0.0120s/iter; left time: 249.4659s
	iters: 600, epoch: 4 | loss: 0.0179234
	speed: 0.0116s/iter; left time: 239.9682s
	iters: 700, epoch: 4 | loss: 0.0156311
	speed: 0.0120s/iter; left time: 247.4054s
	iters: 800, epoch: 4 | loss: 0.0301619
	speed: 0.0121s/iter; left time: 248.1762s
	iters: 900, epoch: 4 | loss: 0.0214266
	speed: 0.0117s/iter; left time: 237.6205s
	iters: 1000, epoch: 4 | loss: 0.0273064
	speed: 0.0125s/iter; left time: 253.9829s
	iters: 1100, epoch: 4 | loss: 0.0208537
	speed: 0.0117s/iter; left time: 236.4689s
	iters: 1200, epoch: 4 | loss: 0.0154416
	speed: 0.0114s/iter; left time: 228.2386s
	iters: 1300, epoch: 4 | loss: 0.0230686
	speed: 0.0109s/iter; left time: 217.4978s
	iters: 1400, epoch: 4 | loss: 0.0175613
	speed: 0.0111s/iter; left time: 220.4975s
	iters: 1500, epoch: 4 | loss: 0.0223321
	speed: 0.0112s/iter; left time: 221.1567s
	iters: 1600, epoch: 4 | loss: 0.0168345
	speed: 0.0110s/iter; left time: 217.1450s
	iters: 1700, epoch: 4 | loss: 0.0215493
	speed: 0.0112s/iter; left time: 219.7674s
	iters: 1800, epoch: 4 | loss: 0.0234569
	speed: 0.0119s/iter; left time: 231.1868s
	iters: 1900, epoch: 4 | loss: 0.0190157
	speed: 0.0116s/iter; left time: 224.0859s
	iters: 2000, epoch: 4 | loss: 0.0434446
	speed: 0.0113s/iter; left time: 218.3362s
	iters: 2100, epoch: 4 | loss: 0.0161970
	speed: 0.0118s/iter; left time: 226.9434s
	iters: 2200, epoch: 4 | loss: 0.0199520
	speed: 0.0122s/iter; left time: 231.9435s
	iters: 2300, epoch: 4 | loss: 0.0329528
	speed: 0.0124s/iter; left time: 234.8788s
	iters: 2400, epoch: 4 | loss: 0.0247711
	speed: 0.0115s/iter; left time: 217.1800s
	iters: 2500, epoch: 4 | loss: 0.0262771
	speed: 0.0118s/iter; left time: 222.3182s
	iters: 2600, epoch: 4 | loss: 0.0196111
	speed: 0.0114s/iter; left time: 213.0343s
	iters: 2700, epoch: 4 | loss: 0.0187202
	speed: 0.0116s/iter; left time: 215.6153s
	iters: 2800, epoch: 4 | loss: 0.0247064
	speed: 0.0120s/iter; left time: 222.7616s
	iters: 2900, epoch: 4 | loss: 0.0180439
	speed: 0.0114s/iter; left time: 209.2739s
	iters: 3000, epoch: 4 | loss: 0.0200687
	speed: 0.0111s/iter; left time: 202.9922s
Epoch: 4 cost time: 35.256134271621704
Epoch: 4, Steps: 3041 | Train Loss: 0.0210664 Vali Loss: 0.1545279 Test Loss: 0.1102871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : informer_custom_ftMS_sl96_ll48_pl24_dm256_nh8_el2_dl1_df1024_atprob_fc5_ebtimeF_dtTrue_mxTrue_exp_095_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 13913
test shape: (869, 16, 24, 1) (869, 16, 24, 1)
test shape: (13904, 24, 1) (13904, 24, 1)
mse:0.06698819994926453, mae:0.20172934234142303, r2:0.6074756681919098


Parsed metrics from Informer output (normalized scale):
  MSE:  0.0670
  MAE:  0.2017
  RMSE: 0.2588
  R2:   0.6075

Metrics after inverse transformation (original scale):
  MSE:  8.7067
  MAE:  2.2998
  RMSE: 2.9507
  R2:   0.6075
  Training time: 171.38s
  RMSE: 2.9507
  MAE:  2.2998
  R2:   0.6075

Saving results...
  Model: Native Informer (saved in external/Informer2020/checkpoints/)
  Predictions: Not saved (native Informer handles this internally)
  Metrics: E:\ANUS_learning\MSI5001-power-transformer-oil-temperature-prediction\models\experiments\exp_095_metrics.json
  Plot: Skipped (native Informer handles visualization internally)

======================================================================
Experiment complete: exp_095
======================================================================

======================================================================
Completed: 2025-11-01 00:36:29
Return code: 0
======================================================================
