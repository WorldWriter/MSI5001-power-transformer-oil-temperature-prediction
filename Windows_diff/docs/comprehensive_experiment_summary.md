# 时间窗口长度实验 - 综合总结报告

**项目**: MSI5001 变压器油温预测
**实验类型**: 时间窗口长度对预测性能影响分析
**完成时间**: 2025-10-14

## 实验概述

本实验系统性地研究了不同历史时间窗口长度对变压器油温预测性能的影响。通过测试12种不同的时间窗口配置，涵盖3种预测跨度（1小时、1天、1周）和3种机器学习模型（Random Forest、Ridge Regression、MLP），我们获得了关于时间窗口优化的重要洞察。

## 实验设计

### 测试配置
- **总配置数**: 12个
- **预测跨度**: 1小时、24小时、168小时（1周）
- **历史窗口范围**: 4小时 - 672小时
- **模型类型**: Random Forest、Ridge Regression、MLP
- **总训练模型数**: 36个

### 数据处理
- **数据集大小**: 训练集 6400样本，测试集 1600样本
- **特征工程**: 时间序列展平为传统ML特征
- **标准化**: 使用StandardScaler进行特征缩放
- **评估指标**: R²、RMSE、MAE、训练时间

## 关键发现

### 🏆 最佳配置
- **模型**: Random Forest
- **预测跨度**: 1小时
- **历史窗口**: 8小时
- **性能**: R² = 0.2585, RMSE = 4.9119

### 📊 性能趋势分析

#### 1小时预测
- **Random Forest**: 短窗口表现更好（8小时最优）
- **Ridge Regression**: 性能随窗口增长急剧下降
- **MLP**: 中等窗口（12小时）表现相对较好

#### 24小时预测
- **Random Forest**: 长窗口表现更好（168小时最优）
- **Ridge Regression**: 严重过拟合，性能极差
- **MLP**: 长窗口略有改善但整体表现不佳

#### 168小时预测
- **Random Forest**: 中等窗口最优（336小时）
- **Ridge Regression**: 极长窗口表现相对较好
- **MLP**: 中等窗口表现最佳

### 🔍 模型特性分析

#### Random Forest
- **优势**: 整体表现最稳定，R²值始终为正
- **最佳场景**: 短期预测（1小时）
- **窗口敏感性**: 对窗口长度较为敏感

#### Ridge Regression
- **劣势**: 严重过拟合，R²值多为负数
- **问题**: 高维特征导致正则化失效
- **建议**: 不适合此类时间序列预测任务

#### MLP (多层感知机)
- **表现**: 中等，但不如Random Forest稳定
- **特点**: 对窗口长度敏感性适中
- **潜力**: 可能需要更复杂的架构优化

## 实用建议

### 1. 窗口长度选择策略
- **短期预测（≤1小时）**: 使用8-12小时历史窗口
- **中期预测（1天）**: 使用7天（168小时）历史窗口
- **长期预测（1周）**: 使用2周（336小时）历史窗口

### 2. 模型选择建议
- **首选**: Random Forest - 稳定性好，解释性强
- **备选**: 优化后的MLP - 潜在更高性能
- **避免**: Ridge Regression - 不适合高维时间序列

### 3. 计算资源考虑
- **训练时间**: 随窗口长度和模型复杂度显著增长
- **内存需求**: 长窗口配置需要更多内存
- **实时预测**: 考虑推理时间与精度的权衡

## 技术实现亮点

### 自动化实验框架
- **模块化设计**: 预处理、训练、分析分离
- **配置驱动**: 易于扩展新的窗口配置
- **结果追踪**: 完整的实验记录和可视化

### 数据处理优化
- **内存效率**: 批量处理大规模时间序列
- **特征工程**: 时间序列到表格数据的高效转换
- **标准化**: 确保不同窗口长度的公平比较

### 可视化分析
- **性能热力图**: 直观展示最佳配置
- **趋势分析**: R²和RMSE随窗口长度的变化
- **训练时间分析**: 计算成本可视化

## 局限性与改进方向

### 当前局限性
1. **数据集单一**: 仅基于一个变压器的数据
2. **模型简单**: 未测试更先进的深度学习模型
3. **特征工程**: 可能遗漏重要的时间特征
4. **季节性**: 未充分考虑长期季节性模式

### 未来改进
1. **多数据集验证**: 扩展到更多变压器数据
2. **深度模型**: 测试LSTM、Transformer等序列模型
3. **自适应窗口**: 动态调整窗口长度
4. **特征增强**: 加入更多领域知识特征

## 结论

本实验成功验证了时间窗口长度对预测性能的显著影响。主要结论：

1. **Random Forest + 8小时窗口** 是1小时预测的最佳配置
2. **窗口长度需要根据预测跨度调整** - 短期预测用短窗口，长期预测用长窗口
3. **Ridge Regression不适合** 高维时间序列预测任务
4. **计算成本与性能** 需要平衡考虑

这些发现为实际部署提供了重要指导，有助于在预测精度和计算效率之间找到最佳平衡点。

---
*报告生成时间: 2025-10-14*
*实验代码位置: `/Windows_diff/scripts/`*
*详细结果位置: `/Windows_diff/docs/window_length_analysis_report.md`*