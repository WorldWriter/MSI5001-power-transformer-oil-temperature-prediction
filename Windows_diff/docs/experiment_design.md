# 时间窗口长度对预测性能影响实验

## 1. 实验背景

基于当前项目的时间序列预测模型，我们发现不同的时间窗口配置对预测性能有显著影响。本实验旨在系统性地研究**历史数据窗口长度**对不同预测时间跨度的影响。

## 2. 当前配置分析

### 2.1 现有时间窗口配置

根据项目中的预处理脚本分析，当前使用的配置如下：

| 预测目标 | 当前lookback | 当前forecast_horizon | 历史时长 | 预测时长 |
|----------|-------------|---------------------|----------|----------|
| 1小时预测 | 16个时间点 | 4个时间点 | 4小时 | 1小时 |
| 1天预测 | 32个时间点 | 96个时间点 | 8小时 | 1天 |
| 1周预测 | 64个时间点 | 672个时间点 | 16小时 | 1周 |

**注意**: 数据采样频率为15分钟一次，即每小时4个时间点。

### 2.2 当前配置的特点

1. **渐进式增长**: 随着预测时间跨度增加，历史窗口也相应增长
2. **相对较短**: 最长历史窗口仅16小时，可能无法捕捉长期模式
3. **固定比例**: 历史窗口与预测跨度的比例不一致

## 3. 实验设计

### 3.1 实验假设

1. **更长的历史窗口**可能提供更丰富的模式信息
2. **不同预测跨度**对历史窗口长度的敏感性不同
3. **存在最优窗口长度**，超过该长度性能不再提升甚至下降

### 3.2 实验配置

我们将测试以下时间窗口配置：

#### 1小时预测实验
| 配置名 | lookback | 历史时长 | 说明 |
|--------|----------|----------|------|
| 1h_base | 16 | 4小时 | 当前基线配置 |
| 1h_ext1 | 32 | 8小时 | 扩展至8小时 |
| 1h_ext2 | 48 | 12小时 | 扩展至12小时 |
| 1h_ext3 | 96 | 24小时 | 扩展至1天 |

#### 1天预测实验
| 配置名 | lookback | 历史时长 | 说明 |
|--------|----------|----------|------|
| 1d_base | 32 | 8小时 | 当前基线配置 |
| 1d_ext1 | 64 | 16小时 | 扩展至16小时 |
| 1d_ext2 | 96 | 24小时 | 扩展至1天 |
| 1d_ext3 | 192 | 48小时 | 扩展至2天 |
| 1d_ext4 | 288 | 72小时 | 扩展至3天 |

#### 1周预测实验
| 配置名 | lookback | 历史时长 | 说明 |
|--------|----------|----------|------|
| 1w_base | 64 | 16小时 | 当前基线配置 |
| 1w_ext1 | 192 | 48小时 | 扩展至2天 |
| 1w_ext2 | 288 | 72小时 | 扩展至3天 |
| 1w_ext3 | 672 | 168小时 | 扩展至1周 |
| 1w_ext4 | 1344 | 336小时 | 扩展至2周 |

### 3.3 评估指标

- **R² (决定系数)**: 衡量模型解释方差的能力
- **RMSE (均方根误差)**: 预测误差的标准差，单位°C
- **MAE (平均绝对误差)**: 预测误差的平均绝对值，单位°C
- **训练时间**: 模型训练耗时
- **内存使用**: 数据处理和模型训练的内存需求

### 3.4 模型选择

基于之前的实验结果，我们将使用以下模型：
- **Random Forest**: 表现最佳的传统机器学习模型
- **Ridge Regression**: 作为线性基线对比
- **MLP (中型)**: 代表深度学习方法

## 4. 预期结果

### 4.1 性能趋势预测

1. **短期预测(1小时)**:
   - 预期在8-12小时历史窗口达到最佳性能
   - 过长窗口可能引入噪声，性能下降

2. **中期预测(1天)**:
   - 预期需要1-2天的历史数据获得最佳性能
   - 季节性和日周期模式的重要性增加

3. **长期预测(1周)**:
   - 预期需要1-2周的历史数据
   - 长期趋势和周期性模式更加重要

### 4.2 模型差异预测

- **Random Forest**: 对窗口长度相对不敏感，性能稳定
- **Ridge Regression**: 在高维数据下可能出现过拟合
- **MLP**: 可能需要更长的历史窗口来学习复杂模式

## 5. 实验实施计划

1. **数据预处理**: 为每种配置生成对应的训练/测试数据集
2. **模型训练**: 在所有配置下训练三种模型
3. **性能评估**: 记录所有评估指标
4. **结果分析**: 识别最优配置和性能趋势
5. **报告撰写**: 总结发现和建议

## 6. 资源需求

- **计算时间**: 预计需要2-4小时完成所有实验
- **存储空间**: 约500MB用于存储不同配置的数据集
- **内存需求**: 峰值约2-4GB（处理最大窗口配置时）

## 7. 风险评估

1. **内存限制**: 最大窗口配置可能导致内存不足
2. **训练时间**: 某些配置的训练时间可能过长
3. **数据稀疏**: 过长的历史窗口可能导致有效样本数量不足

## 8. 成功标准

1. 完成所有配置的实验运行
2. 识别每个预测跨度的最优历史窗口长度
3. 量化窗口长度对性能的影响程度
4. 提供实用的配置建议