# 时间窗口长度对预测性能影响分析报告

**生成时间**: 2025-10-14 14:09:08

## 执行摘要

本报告分析了不同历史时间窗口长度对变压器油温预测性能的影响。通过系统性实验，我们测试了多种窗口长度配置在1小时、1天和1周预测任务上的表现。

## 实验配置

### 测试的时间窗口配置

**1.0小时预测**:
- 历史窗口: 4.0小时 (16个时间点)
- 历史窗口: 8.0小时 (32个时间点)
- 历史窗口: 12.0小时 (48个时间点)
- 历史窗口: 24.0小时 (96个时间点)

**24.0小时预测**:
- 历史窗口: 24.0小时 (96个时间点)
- 历史窗口: 48.0小时 (192个时间点)
- 历史窗口: 72.0小时 (288个时间点)
- 历史窗口: 168.0小时 (672个时间点)

**168.0小时预测**:
- 历史窗口: 168.0小时 (672个时间点)
- 历史窗口: 336.0小时 (1344个时间点)
- 历史窗口: 504.0小时 (2016个时间点)
- 历史窗口: 672.0小时 (2688个时间点)

### 评估模型
- **Random Forest**: 集成学习方法，适合处理非线性关系
- **Ridge Regression**: 线性回归，具有L2正则化
- **MLP**: 多层感知机神经网络

### 评估指标
- **R² Score**: 决定系数，衡量模型解释方差的能力
- **RMSE**: 均方根误差，衡量预测精度
- **MAE**: 平均绝对误差
- **Training Time**: 模型训练时间

## 主要发现

### 最佳配置总结

**1.0小时预测的最佳配置**:

- **MLP**: 历史窗口 12.0小时, R² = -0.9123, RMSE = 7.9360
- **RandomForest**: 历史窗口 8.0小时, R² = 0.2585, RMSE = 4.9119
- **Ridge**: 历史窗口 4.0小时, R² = -6.4580, RMSE = 15.5352

**24.0小时预测的最佳配置**:

- **MLP**: 历史窗口 168.0小时, R² = -1.4306, RMSE = 11.1433
- **RandomForest**: 历史窗口 168.0小时, R² = 0.0657, RMSE = 6.9087
- **Ridge**: 历史窗口 24.0小时, R² = -10.6957, RMSE = 20.5889

**168.0小时预测的最佳配置**:

- **MLP**: 历史窗口 336.0小时, R² = -0.1116, RMSE = 7.9974
- **RandomForest**: 历史窗口 336.0小时, R² = 0.0809, RMSE = 7.2721
- **Ridge**: 历史窗口 672.0小时, R² = -1.1429, RMSE = 12.0349

### 性能趋势分析

**1.0h预测**:

- **RandomForest**: 随历史窗口增长而下降 (R²与历史窗口相关性: -0.769)
- **Ridge**: 随历史窗口增长而下降 (R²与历史窗口相关性: -0.960)
- **MLP**: 随历史窗口增长而改善 (R²与历史窗口相关性: 0.138)

**24.0h预测**:

- **RandomForest**: 随历史窗口增长而改善 (R²与历史窗口相关性: 0.680)
- **Ridge**: 随历史窗口增长而下降 (R²与历史窗口相关性: -0.995)
- **MLP**: 随历史窗口增长而改善 (R²与历史窗口相关性: 0.332)

**168.0h预测**:

- **RandomForest**: 随历史窗口增长而下降 (R²与历史窗口相关性: -0.692)
- **Ridge**: 随历史窗口增长而改善 (R²与历史窗口相关性: 0.782)
- **MLP**: 随历史窗口增长而改善 (R²与历史窗口相关性: 0.453)

## 详细实验结果

### 1.0小时预测结果

| 历史窗口(h) | 模型类型 | R² Score | RMSE | MAE | 训练时间(s) |
|-------------|----------|----------|------|-----|-------------|
| 4.0 | MLP | -1.1559 | 8.3526 | 6.7785 | 1.23 |
| 4.0 | RandomForest | 0.2443 | 4.9451 | 3.9837 | 4.23 |
| 4.0 | Ridge | -6.4580 | 15.5352 | 8.6004 | 0.02 |
| 8.0 | MLP | -1.7036 | 9.3792 | 7.5828 | 1.10 |
| 8.0 | RandomForest | 0.2585 | 4.9119 | 3.9606 | 8.25 |
| 8.0 | Ridge | -10.1943 | 19.0849 | 9.8017 | 0.01 |
| 12.0 | MLP | -0.9123 | 7.9360 | 6.3352 | 1.15 |
| 12.0 | RandomForest | 0.2517 | 4.9643 | 3.9929 | 12.37 |
| 12.0 | Ridge | -12.0750 | 20.7512 | 10.4041 | 0.04 |
| 24.0 | MLP | -1.2399 | 8.7113 | 7.1515 | 1.87 |
| 24.0 | RandomForest | 0.2251 | 5.1236 | 4.1190 | 25.15 |
| 24.0 | Ridge | -15.6491 | 23.7497 | 11.8012 | 0.10 |

### 24.0小时预测结果

| 历史窗口(h) | 模型类型 | R² Score | RMSE | MAE | 训练时间(s) |
|-------------|----------|----------|------|-----|-------------|
| 24.0 | MLP | -1.4733 | 9.4680 | 7.6045 | 3.02 |
| 24.0 | RandomForest | -0.0542 | 6.1813 | 5.3471 | 27.14 |
| 24.0 | Ridge | -10.6957 | 20.5889 | 12.0059 | 0.08 |
| 48.0 | MLP | -2.2151 | 10.9019 | 9.1403 | 5.44 |
| 48.0 | RandomForest | 0.0558 | 5.9078 | 5.2341 | 53.68 |
| 48.0 | Ridge | -69.4019 | 51.0145 | 23.1824 | 0.32 |
| 72.0 | MLP | -2.4128 | 11.7053 | 9.5617 | 5.31 |
| 72.0 | RandomForest | -0.0021 | 6.3427 | 5.5409 | 77.69 |
| 72.0 | Ridge | -214.4804 | 93.0109 | 42.0850 | 0.72 |
| 168.0 | MLP | -1.4306 | 11.1433 | 9.2534 | 11.77 |
| 168.0 | RandomForest | 0.0657 | 6.9087 | 6.3607 | 199.36 |
| 168.0 | Ridge | -525.0595 | 163.9349 | 90.8610 | 2.08 |

### 168.0小时预测结果

| 历史窗口(h) | 模型类型 | R² Score | RMSE | MAE | 训练时间(s) |
|-------------|----------|----------|------|-----|-------------|
| 168.0 | MLP | -1.1043 | 11.1572 | 9.0976 | 16.25 |
| 168.0 | RandomForest | 0.0291 | 7.5787 | 6.9369 | 183.95 |
| 168.0 | Ridge | -240.6557 | 119.5627 | 77.8960 | 2.14 |
| 336.0 | MLP | -0.1116 | 7.9974 | 6.7342 | 31.35 |
| 336.0 | RandomForest | 0.0809 | 7.2721 | 6.4980 | 388.62 |
| 336.0 | Ridge | -4.4501 | 17.7085 | 13.9695 | 3.81 |
| 504.0 | MLP | -0.7821 | 10.7512 | 8.8554 | 35.79 |
| 504.0 | RandomForest | 0.0676 | 7.7765 | 6.9844 | 609.50 |
| 504.0 | Ridge | -2.0455 | 14.0546 | 11.3595 | 4.68 |
| 672.0 | MLP | -0.3670 | 9.6123 | 7.9831 | 47.59 |
| 672.0 | RandomForest | -0.2125 | 9.0529 | 7.9259 | 783.57 |
| 672.0 | Ridge | -1.1429 | 12.0349 | 9.7138 | 7.11 |

## 关键洞察与建议

### 整体最佳配置

- **模型**: RandomForest
- **预测跨度**: 1.0小时
- **历史窗口**: 8.0小时
- **性能**: R² = 0.2585, RMSE = 4.9119

### 窗口长度优化效果

- **RandomForest** (1.0h预测): 最优窗口相比最差窗口提升 14.8%
- **Ridge** (1.0h预测): 最优窗口相比最差窗口提升 -58.7%
- **MLP** (1.0h预测): 最优窗口相比最差窗口提升 -46.4%
- **RandomForest** (24.0h预测): 最优窗口相比最差窗口提升 -221.2%
- **Ridge** (24.0h预测): 最优窗口相比最差窗口提升 -98.0%
- **MLP** (24.0h预测): 最优窗口相比最差窗口提升 -40.7%
- **RandomForest** (168.0h预测): 最优窗口相比最差窗口提升 -138.1%
- **Ridge** (168.0h预测): 最优窗口相比最差窗口提升 -99.5%
- **MLP** (168.0h预测): 最优窗口相比最差窗口提升 -89.9%

### 实用建议

1. **短期预测(1小时)**: 建议使用较长的历史窗口以捕获更多模式
2. **中期预测(1天)**: 平衡历史信息量与计算效率
3. **长期预测(1周)**: 关注长期趋势，避免过度拟合短期波动
4. **模型选择**: Random Forest通常表现最佳，MLP适合复杂模式识别
5. **计算资源**: 考虑训练时间与性能的权衡

## 局限性与未来工作

### 当前局限性
- 实验基于单一数据集，泛化性有待验证
- 未考虑季节性和周期性因素的影响
- 计算资源限制了更大窗口长度的测试

### 未来改进方向
- 测试更多样化的数据集
- 引入自适应窗口长度选择机制
- 结合领域知识优化特征工程
- 探索深度学习模型的窗口长度敏感性

---
*本报告由MSI5001项目组自动生成*
